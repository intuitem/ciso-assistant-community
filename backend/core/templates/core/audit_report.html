{% load i18n core_extras %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% trans "Audit report" %}</title>
    <style>
        * { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body { margin: 0; padding: 2rem 0; background-color: #f9fafb; }
        h1, h2, h3, h4, h5, h6 { margin: 0 0 1rem; font-weight: 500; letter-spacing: 0.025em; line-height: 1.3; color: #111827; }
        a { color: #2563eb; text-decoration: none; transition: color 0.15s; }
        a:hover { color: #1d4ed8; text-decoration: underline; }
        p, div, span { font-size: 0.9rem; font-weight: 400; margin: 0; line-height: 1.6; color: #374151; }
        strong, b { font-weight: 600; }
        h1 { font-size: 1.875rem; font-weight: 600; color: #1f2937; }
        ul, ol { margin: 0; padding-left: 1.5rem; }
        ul li { list-style: circle outside; margin-bottom: 0.3rem; }
        ol li { list-style: decimal outside; margin-bottom: 0.3rem; }

        .container { position: relative; width: 100%; margin: 0 auto; padding: 0 2rem; box-sizing: border-box; }
        .container-tablet { max-width: 1200px; background-color: #ffffff; padding: 2rem; border-radius: 0.5rem; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06); }

        hr { margin: 1.5rem 0 !important; border: 0; border-top: 1px solid #e5e7eb; }
        hr.dotted { border-top: 1px dotted #d1d5db; }

        /* Flexbox utilities */
        .flex { display: flex; }
        .flex-row { flex-direction: row; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-center { justify-content: center; }
        .justify-between { justify-content: space-between; }
        .justify-items-left { justify-items: left; }
        .space-x-2 > :not([hidden]) ~ :not([hidden]) { margin-left: 0.5rem; }
        .space-x-4 > :not([hidden]) ~ :not([hidden]) { margin-left: 1rem; }

        /* Grid utilities */
        .grid { display: grid; }
        .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }

        /* Width utilities */
        .w-full { width: 100%; }
        .w-1\/2 { width: 50%; }
        .w-2\/3 { width: 66.666667%; }

        /* Margin utilities */
        .m-2 { margin: 0.5rem; }
        .ml-0 { margin-left: 0; }
        .mb-4 { margin-bottom: 1rem; }

        /* Padding utilities */
        .px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
        .px-4 { padding-left: 1rem; padding-right: 1rem; }
        .py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
        .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }

        /* Border utilities */
        .border { border-width: 1px; border-style: solid; border-color: #e5e7eb; }
        .border-t-2 { border-top-width: 3px; }
        .rounded-lg { border-radius: 0.5rem; }

        /* Shadow utilities */
        .shadow-md { box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06); }

        /* Text utilities */
        .text-left { text-align: left; }
        .text-center { text-align: center; }
        .text-white { color: #ffffff; }
        .font-semibold { font-weight: 600; }
        .whitespace-nowrap { white-space: nowrap; }
        .text-3xl { font-size: 1.875rem; line-height: 2.25rem; }
        .text-xs { font-size: 0.75rem; line-height: 1rem; }

        /* Height utilities */
        .h-4 { height: 1rem; }

        /* Additional flexbox utilities for bar graph */
        .justify-content-center { justify-content: center; }
        .overflow-hidden { overflow: hidden; }
        .rounded-full { border-radius: 9999px; }

        /* Color classes - indigo */
        .bg-indigo-200 { background-color: #e0e7ff; }
        .text-indigo-700 { color: #4338ca; }
        .text-indigo-500 { color: #6366f1; }
        .hover\:text-indigo-500:hover { color: #4f46e5; }

        /* Color classes - dynamic status/result colors */
        .text-gray-300 { color: #d1d5db; }
        .text-gray-400 { color: #9ca3af; }
        .text-green-500 { color: #22c55e; }
        .text-blue-500 { color: #3b82f6; }
        .text-red-500 { color: #ef4444; }
        .text-yellow-400 { color: #facc15; }
        .text-black { color: #000000; }

        .bg-gray-300 { background-color: #d1d5db; }
        .bg-gray-400 { background-color: #9ca3af; }
        .bg-green-500 { background-color: #22c55e; }
        .bg-blue-500 { background-color: #3b82f6; }
        .bg-red-500 { background-color: #ef4444; }
        .bg-yellow-400 { background-color: #facc15; }
        .bg-black { background-color: #000000; }

        .border-gray-300 { border-color: #d1d5db; }
        .border-gray-400 { border-color: #9ca3af; }
        .border-green-500 { border-color: #22c55e; }
        .border-blue-500 { border-color: #3b82f6; }
        .border-red-500 { border-color: #ef4444; }
        .border-yellow-400 { border-color: #facc15; }
        .border-black { border-color: #000000; }

        .border-t-gray-300 { border-top-color: #d1d5db; }
        .border-t-gray-400 { border-top-color: #9ca3af; }
        .border-t-green-500 { border-top-color: #22c55e; }
        .border-t-blue-500 { border-top-color: #3b82f6; }
        .border-t-red-500 { border-top-color: #ef4444; }
        .border-t-yellow-400 { border-top-color: #facc15; }
        .border-t-black { border-top-color: #000000; }

        /* Custom styles */
        .direct_evidences_block, .applied_controls_block {
            list-style-position: inside;
        }

        .node {
            margin-bottom: 1.5rem;
        }

        @media print {
            body { background-color: white; padding: 0; }
            .container-tablet { box-shadow: none; }
        }
    </style>
</head>
<body class="container container-tablet">
    <hr class="dotted">
    <div class="flex flex-row space-x-4 justify-center items-center mb-4">
        <h1 class='text-3xl'>{{ compliance_assessment.name }}: {{ compliance_assessment.framework }}</h1>
        {% if compliance_assessment.get_global_score > -1 %}
            <p class='font-semibold'>{% trans "Score:" %}</p> <span class="font-semibold">{{ compliance_assessment.get_global_score|floatformat }}</span>
        {% endif %}
        {% bar_graph assessments ancestors %}
    </div>
    <div class="flex flex-row space-x-4 mb-4">
        <div>
            <p class='font-semibold'>{% trans "Authors "%}</p>
            <ul>
                {% for author in compliance_assessment.authors.all %}
                    <li>{{ author }}</li>
                {% endfor %}
            </ul>
        </div>
        <div>
            <p class='font-semibold'>{%trans "Reviewers" %}</p>
            <ul>
                {% for group in compliance_assessment.reviewers.all %}
                    <li>{{ group }}</li>
                {% endfor %}
            </ul>
        </div>
        {% with selected_groups=compliance_assessment.get_selected_implementation_groups %}
          {% if selected_groups %}
            <div>
                <p class='font-semibold'>{% trans "Selected implementation groups" %}</p>
                <ul>
                    {% for group in selected_groups %}
                        <li>{{ group }}</li>
                    {% endfor %}
                </ul>
            </div>
          {% endif %}
        {% endwith %}
    </div>

    {% for node in top_level_nodes %}
        {% include "snippets/req_node.html" with node=node %}
    {% endfor %}
</body>
</html>
